<!DOCTYPE html>
<html>
<head>
  <title>Circalify - Simple Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    #test-wheel {
      width: 800px;
      height: 800px;
      margin: 20px auto;
      background: white;
      border: 1px solid #ddd;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .info {
      text-align: center;
      margin: 20px;
    }
    button {
      margin: 5px;
      padding: 10px 20px;
      font-size: 14px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="info">
    <h1>Circalify Test</h1>
    <p>Testing the circular annual wheel visualization library</p>
    <div>
      <button onclick="testBasic()">Basic Test</button>
      <button onclick="testMultipleEvents()">Multiple Events</button>
      <button onclick="testZoom()">Test Zoom</button>
      <button onclick="testUpdate()">Test Update</button>
      <button onclick="testDestroy()">Test Destroy</button>
    </div>
  </div>

  <div id="test-wheel"></div>

  <script src="circalify.js"></script>

  <script>
    let wheel = null;

    // Basic test
    function testBasic() {
      if (wheel) wheel.destroy();

      const container = document.getElementById('test-wheel');
      const data = [
        { date: new Date(2024, 0, 15), label: 'Event 1', ring: 'Ring 1' },
        { date: new Date(2024, 5, 20), label: 'Event 2', ring: 'Ring 2' },
        { date: new Date(2024, 11, 25), label: 'Event 3', ring: 'Ring 3' }
      ];

      wheel = new Circalify(container, data, {
        rings: ['Ring 1', 'Ring 2', 'Ring 3'],
        colors: ['#3498db', '#e74c3c', '#2ecc71'],
        showTimeline: true
      });

      console.log('✅ Basic test completed');
    }

    // Test with multiple overlapping events
    function testMultipleEvents() {
      if (wheel) wheel.destroy();

      const container = document.getElementById('test-wheel');
      const data = [];

      // Create events with some collisions
      for (let month = 0; month < 12; month++) {
        for (let ring = 0; ring < 3; ring++) {
          data.push({
            date: new Date(2024, month, 15),
            label: `M${month + 1} R${ring + 1}`,
            ring: ['Operations', 'Finance', 'HR'][ring]
          });
        }
      }

      // Add some events on same date to test collision detection
      data.push(
        { date: new Date(2024, 3, 15), label: 'Collision 1', ring: 'Operations' },
        { date: new Date(2024, 3, 15), label: 'Collision 2', ring: 'Operations' },
        { date: new Date(2024, 3, 15), label: 'Collision 3', ring: 'Operations' }
      );

      wheel = new Circalify(container, data, {
        rings: ['Operations', 'Finance', 'HR'],
        colors: ['#3498db', '#9b59b6', '#e74c3c'],
        showTimeline: true,
        onEventClick: (event) => {
          alert(`Clicked: ${event.label}`);
        }
      });

      console.log('✅ Multiple events test completed');
    }

    // Test zoom functionality
    function testZoom() {
      if (!wheel) {
        alert('Create a wheel first!');
        return;
      }

      // Enable zoom if not already
      wheel.options.enableZoom = true;
      wheel._addZoomControls();

      // Test programmatic zoom
      setTimeout(() => {
        wheel.setZoomLevel(6);
        console.log('Zoomed to 6 months');
      }, 1000);

      setTimeout(() => {
        wheel.setZoomLevel(3);
        console.log('Zoomed to 3 months');
      }, 2000);

      setTimeout(() => {
        wheel.setZoomLevel(12);
        console.log('Back to 12 months');
      }, 3000);

      console.log('✅ Zoom test started');
    }

    // Test update functionality
    function testUpdate() {
      if (!wheel) {
        alert('Create a wheel first!');
        return;
      }

      const newData = [
        { date: new Date(2024, 2, 10), label: 'Updated 1', ring: wheel.options.rings[0], color: '#f39c12' },
        { date: new Date(2024, 6, 15), label: 'Updated 2', ring: wheel.options.rings[1], color: '#f39c12' },
        { date: new Date(2024, 10, 20), label: 'Updated 3', ring: wheel.options.rings[2], color: '#f39c12' }
      ];

      wheel.update(newData);
      console.log('✅ Update test completed');
    }

    // Test destroy functionality
    function testDestroy() {
      if (!wheel) {
        alert('Create a wheel first!');
        return;
      }

      wheel.destroy();
      wheel = null;
      console.log('✅ Destroy test completed');
    }

    // Run basic test on load
    window.addEventListener('DOMContentLoaded', () => {
      testBasic();
    });
  </script>
</body>
</html>